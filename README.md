Based on https://gist.github.com/withr/9001831
